<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="dao.CallStuDao">
    <resultMap id="studentResultMap" type="entity.Student">
        <result column="sid" property="sid" />
        <result column="student_token" property="token" />
        <result column="student_name" property="name" />
        <result column="student_major" property="major" />
        <result column="student_college" property="college" />
        <result column="student_sex" property="sex" />
        <result column="student_passwd" property="passwd" />
        <result column="student_phone" property="phone" />
    </resultMap>

    <insert id="addCallStudent">
        insert into scuee.call_student
            (course_id, call_date, call_time, student_id)
        values
            (#{id}, #{date}, #{time}, #{sid});
    </insert>

    <select id="checkToken" resultType="java.lang.Integer">
        select exists(
            select *
            from scuee.classroom c
            where
                c.classroom_token = #{token}
                   );
    </select>

    <select id="selectStudentByUid" resultMap="studentResultMap">
        select student.*
        from
            (select * from scuee.qrcode_student where uid = #{uid})qs
        inner join scuee.student s
        on qs.student_id = s.sid;
    </select>
</mapper>